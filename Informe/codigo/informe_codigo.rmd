---
title: "Proyecto de Ciencia de Datos Reproducible"
output: html_document
date: "2025-09-01"
toc: TRUE
number_sections: TRUE
toc_true: TRUE

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.width = 8, fig.height = 8)

# Librerías principales
library(readr)     # Importación de datos
library(dplyr)     # Manipulación de datos
library(ggplot2)   # Visualización
library(here)      # Manejo de rutas reproducibles
library(kableExtra)  # Tablas bonitas en RMarkdown


# Opciones globales de knitr
knitr::opts_chunk$set(
  echo = TRUE,      # Muestra código en el informe
  warning = FALSE,  # Oculta warnings
  message = FALSE   # Oculta mensajes de carga
)

```
# Introducción

Este informe forma parte de un proyecto de **ciencia de datos reproducible**.  
El objetivo principal es analizar y comparar la evolución de la **esperanza de vida** en España, Francia, Italia y Alemania utilizando datos de Gapminder.  

# Objetivos

- Importar y depurar los datos de los países seleccionados.  
- Transformar los datos a un formato adecuado para análisis temporal.  
- Calcular indicadores descriptivos de esperanza de vida.  
- Visualizar comparativamente la evolución histórica.  
- Comunicar los hallazgos de forma reproducible. 

# Datos 

```{r, message=FALSE, warning=FALSE}

install.packages("here")
install.packages("kableExtra")

datos <- read_csv(here("Datos/base_depurada/LifeExpact_dep.csv"))

head(datos)

```

# Tabla resumen

```{r}

tabla_resume <- datos %>% 
  group_by(country) %>% 
  summarise(
    Mean = mean(life_expectancy, na.rm = TRUE),
    SD   = sd(life_expectancy, na.rm = TRUE),
    Min  = min(life_expectancy, na.rm = TRUE),
    Max  = max(life_expectancy, na.rm = TRUE),
    .groups = 'drop'
  ) %>% 
  as.data.frame() %>% 
  kable() %>% 
  kable_styling("striped")

tabla_resume

```

# Gráfico comparativo

```{r}

## Gráfico comparativo de la evolución entre países 

ggplot(datos, aes(x = year, y = life_expectancy, color = country)) +
  geom_line(size = 1) +
  labs(
    title = "Evolución de la esperanza de vida",
    x = "Año",
    y = "Esperanza de vida (años)"
  ) +
  theme_minimal()

```

```{r, nombre_chunk}

# Seleccionar solo los años de interés
datos_analisis <- datos %>%
  filter(year %in% c(1950, 2020)) %>%
  group_by(year, country) %>%
  summarise(
    Life_Expectancy = round(mean(life_expectancy, 1))
  ) %>%
  ungroup()

# Pivotar para tener columnas por año
tabla_comp <- datos_analisis %>%
  pivot_wider(names_from = year, values_from = Life_Expectancy)

# Mostrar tabla bonita
tabla_comp %>%
  kable("html", caption = "Comparación de esperanza de vida: 1950 vs 2020") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE)

